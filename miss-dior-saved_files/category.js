var categoryModule;
categoryModule=function(){var xhr,delClearFilterButton=false;function init(){jQuery(".filter div.column select").chosen({disable_search:true});restoreProductListNavigationData();bindEvents()}function destroy(){unbindEvents()}function bindEvents(){bindWishlistEvents();bindFilterEvents();bindProductListEvents();jQuery("#load_more_products_btn").on("click",loadMoreProducts);jQuery("#sort-order-select").change(function(){sortWithFilter(this);if(!jQuery(".filter-item-container input:checked").length)delClearFilterButton=true});
jQuery(window).on("ajaxComplete",function(){setTimeout(function(){jQuery.extend(jQuery.lazyLoadXT,{forceLoad:false});jQuery(window).lazyLoadXT()},50)});jQuery(window).unload(function(){if(!jQuery(".product-back-button").length)saveScrollPosition()})}function unbindEvents(){jQuery("#load_more_products_btn").off("click",loadMoreProducts);jQuery(".filter-item-container label").off("click",checkboxChange);jQuery(".filter-item-container div.chosen-container").off("click",showHideCheckboxContainer);jQuery(".filter div.column").off("click",
"ul.selected a",deleteActiveFilter);jQuery(window).off("resize",initFilterWidth)}function bindProductListEvents(){jQuery(".product-grid.category-products .product-item a").on("click",function(e){saveProductListNavigationData()});productItemTouchEvent()}function createWishlistProductMarkup(res){var productData=res.added_product_data;var correctPrice;correctPrice=productData.price.toFixed();if(correctPrice<=0)correctPrice="\u0426\u0435\u043d\u0430 \u0443\u0442\u043e\u0447\u043d\u044f\u0435\u0442\u0441\u044f";
else correctPrice=productData.price.toString()+" <span>"+inputOptions.currencySign+"</span>";var relocateLink='<a class="btn-relocate move-to-cart" href="#" '+'title="'+Translator.translate("Add item")+'" '+'data-id="'+res.wishlist_item_id+'" '+'data-carturl="'+productData.buy_url+'" '+'">'+Translator.translate("Add item")+"</a> ";if(productData.is_configurable)relocateLink="";return"<li> "+'<a class="btn-remove" href="#" title="'+Translator.translate("Remove item")+'" data-id="'+res.wishlist_item_id+
'">Remove item</a> '+relocateLink+'<div class="checkout-item-left"> '+'<a href="'+productData.url+'">'+'<img src="'+productData.image_url+'" width="90" height="138" alt="PRODUCT_NAME image" class="mCS_img_loaded"> '+"</a> "+"</div> "+'<div class="checkout-item-right"> '+"<p> "+'<a href="'+productData.url+'">'+productData.name+"</a> "+"</p> "+"<p> "+'<span class="brand">'+productData.brand+"</span> "+"</p> "+'<div class="price-box"> '+'<div class="special-price"> '+'<div class="price"> '+'<span class="price">'+
correctPrice+"</span> "+"</div> "+"</div> "+"</div> "+"</div> "+"</li>"}function addToWishList(event){event.preventDefault();var wishlistBar=jQuery("#wishlist_bar_show");if(!userIsLoggedIn){jQuery.removeCookie("__auth",{path:"/"});jQuery("body").addClass("layout-active");jQuery("#login").addClass("popup-active").find(".layout-close").one("click",function(event){event.preventDefault();jQuery("body").removeClass("layout-active");jQuery("#login").removeClass("popup-active")});return}if(!jQuery(event.currentTarget).closest(".favored").length){jQuery(event.currentTarget).find("i").addClass("wishlist-icon-push");
jQuery(event.currentTarget).find("i").one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){jQuery(event.currentTarget).find("i").removeClass("wishlist-icon-push")});jQuery(".ajaxwishlist-overlay").show();jQuery(event.currentTarget).parent().addClass("favored");jQuery("#wishlist_bar_show").find(".quantity").text(parseInt(jQuery("#wishlist_bar_show").find(".quantity").text(),10)+1);wishlistBar.removeClass("inactive");jQuery(".favorite-icon").clone().addClass("fill").css({"position":"absolute",
"z-index":"1000","left":0,"marginTop":"1px","marginLeft":"11px"}).appendTo("#wishlist_bar_show").addClass("wishlist-icon-pop").one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){jQuery(".wishlist-icon-pop").fadeOut(1E3,function(){jQuery(this).remove()})})}else{jQuery(event.currentTarget).find("i").addClass("wishlist-icon-push");jQuery(event.currentTarget).find("i").one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){jQuery(event.currentTarget).find("i").removeClass("wishlist-icon-push")});
jQuery(".favorite-icon").clone().addClass("fill").css({"position":"absolute","z-index":"1000","left":0,"marginTop":"1px","marginLeft":"11px"}).appendTo("#wishlist_bar_show").addClass("favorite-icon-float-away").one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){jQuery(this).remove()});jQuery(event.currentTarget).closest(".favored").removeClass("favored");jQuery("#wishlist_bar_show").find(".quantity").text(parseInt(jQuery("#wishlist_bar_show").find(".quantity").text(),10)-
1)}var oldCount=parseInt(jQuery("#favs-popup-bar").find(".count").text(),10);jQuery.ajax(window.location.origin+"/wishlist/index/add",{method:"POST",data:{product:jQuery(event.currentTarget).data("id")},success:function(response){var respData=JSON.parse(response);jQuery(".ajaxwishlist-overlay").hide();if(typeof respData==="object")if(oldCount<respData.wishlist_qty){jQuery("#favs-popup-bar").find(".count").text(respData.wishlist_qty);wishlistBar.find(".quantity").text(respData.wishlist_qty);wishlistBar.removeClass("inactive");
jQuery("#wishlist-content").append(createWishlistProductMarkup(respData))}else{jQuery(event.currentTarget).closest(".favored").removeClass("favored");removeFromWishListIfPresent(respData.wishlist_item_id)}else alert("\u0421\u0435\u0440\u0432\u0435\u0440 \u0432\u0435\u0440\u043d\u0443\u043b \u043d\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435.")},error:function(response){var respData=JSON.parse(response);if(typeof respData==="object")alert('\u041e\u0448\u0438\u0431\u043a\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0432 "\u0421\u043f\u0438\u0441\u043e\u043a \u0436\u0435\u043b\u0430\u0435\u043c\u043e\u0433\u043e".',
respData.statusText);else alert("\u0421\u0435\u0440\u0432\u0435\u0440 \u0432\u0435\u0440\u043d\u0443\u043b \u043d\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435.")},complete:function(){jQuery(".ajaxwishlist-overlay").hide()}})}function removeFromWishList(event){event.preventDefault();var wishlistBar=jQuery("#wishlist_bar_show");var favsPopup=jQuery("#favs-popup-bar");jQuery(".ajaxwishlist-overlay").show();jQuery(event.currentTarget).closest(".product-item").remove();
jQuery.ajax(window.location.origin+"/wishlist/index/remove",{method:"POST",data:{item:jQuery(event.currentTarget).data("id")},success:function(response){var respData=JSON.parse(response);jQuery(".ajaxwishlist-overlay").hide();if(typeof respData==="object")if(respData.statusDel==="true"){jQuery("#favs-popup-bar").find(".count").text(respData.wishlist_qty);wishlistBar.find(".quantity").text(respData.wishlist_qty);if(respData.wishlist_qty===0){wishlistBar.addClass("inactive");favsPopup.removeClass("popup-active")}var wishContent=
jQuery("#wishlist-content").find("li");jQuery.each(wishContent,function(index,value){if(jQuery(value).find(".btn-remove").data("id")==jQuery(event.currentTarget).data("id"))jQuery(value).remove()});var wishlistPageContent=jQuery("#wishlist-page").find("li");jQuery.each(wishlistPageContent,function(index,value){if(jQuery(value).find(".delete-link").data("id")==jQuery(event.currentTarget).data("id"))jQuery(value).remove()});var favContent=jQuery(".favored").find(".link-wishlist");jQuery.each(favContent,
function(index,value){if(jQuery(value).data("id")==respData.delProductId)jQuery(value).closest(".favored").removeClass("favored")})}else alert('\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0438\u0437 "\u0421\u043f\u0438\u0441\u043e\u043a\u0430 \u0436\u0435\u043b\u0430\u0435\u043c\u043e\u0433\u043e".');else alert("\u0421\u0435\u0440\u0432\u0435\u0440 \u0432\u0435\u0440\u043d\u0443\u043b \u043d\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435.")},
error:function(response){var respData=JSON.parse(response);if(typeof respData==="object")alert('\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0438\u0437 "\u0421\u043f\u0438\u0441\u043e\u043a\u0430 \u0436\u0435\u043b\u0430\u0435\u043c\u043e\u0433\u043e".',respData.statusText);else alert("\u0421\u0435\u0440\u0432\u0435\u0440 \u0432\u0435\u0440\u043d\u0443\u043b \u043d\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435.")},
complete:function(){jQuery(".ajaxwishlist-overlay").hide()}})}function openLoginPopupForGuests(event){if(userIsLoggedIn)return;event.preventDefault();openLoginPopup()}function removeFromWaitProductList(event){event.preventDefault();jQuery(event.currentTarget).closest(".product-item").remove();jQuery.ajax(window.location.origin+"/customaccount/wait/remove",{method:"POST",data:{item:jQuery(event.currentTarget).data("id")},success:function(response){var respData=response;if(typeof respData==="object")if(respData.statusDel===
"true"){var waitlistPageContent=jQuery("#waiting-page").find("li");jQuery.each(waitlistPageContent,function(index,value){if(jQuery(value).find(".delete-link").data("id")==jQuery(event.currentTarget).data("id"))jQuery(value).remove()});jQuery("ul.menu").find(".active").find(".count").text(respData.waitlist_qty||"")}else alert('\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0438\u0437 c\u043f\u0438\u0441\u043e\u043a\u0430".');else alert("\u0421\u0435\u0440\u0432\u0435\u0440 \u0432\u0435\u0440\u043d\u0443\u043b \u043d\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435.")},
error:function(response){var respData=response;if(typeof respData==="object")alert('\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0438\u0437 c\u043f\u0438\u0441\u043a\u0430".',respData.statusText);else alert("\u0421\u0435\u0440\u0432\u0435\u0440 \u0432\u0435\u0440\u043d\u0443\u043b \u043d\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435.")},complete:function(){}})}function removeFromWishListIfPresent(itemId){var wishlistBar=
jQuery("#wishlist_bar_show");var favsPopup=jQuery("#favs-popup-bar");jQuery(".ajaxwishlist-overlay").show();jQuery.ajax(window.location.origin+"/wishlist/index/remove",{method:"POST",data:{item:itemId},success:function(response){var respData=JSON.parse(response);if(typeof respData==="object"){var wlContent=jQuery("#wishlist-content").find("li");jQuery.each(wlContent,function(index,value){if(itemId==jQuery(value).find(".btn-remove").data("id"))jQuery(value).remove()});var wishlistPageContent=jQuery("#wishlist-page").find("li");
jQuery.each(wishlistPageContent,function(index,value){if(itemId==jQuery(value).find(".delete-link").data("id"))jQuery(value).remove()});jQuery("#favs-popup-bar").find(".count").text(respData.wishlist_qty);wishlistBar.find(".quantity").text(respData.wishlist_qty);if(respData.wishlist_qty===0){wishlistBar.addClass("inactive");favsPopup.removeClass("popup-active")}}else alert("\u0421\u0435\u0440\u0432\u0435\u0440 \u0432\u0435\u0440\u043d\u0443\u043b \u043d\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435.")},
error:function(response){var respData=JSON.parse(response);if(typeof respData==="object")alert('\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0438\u0437 "\u0421\u043f\u0438\u0441\u043e\u043a\u0430 \u0436\u0435\u043b\u0430\u0435\u043c\u043e\u0433\u043e".',respData.statusText);else alert("\u0421\u0435\u0440\u0432\u0435\u0440 \u0432\u0435\u0440\u043d\u0443\u043b \u043d\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435.")},
complete:function(){jQuery(".ajaxwishlist-overlay").hide()}})}function bindWishlistEvents(){jQuery(".listing-page").on("click","ul.list .link-wishlist",addToWishList);jQuery("#carousel_content").on("click",".link-wishlist",addToWishList);jQuery("#related-products").on("click",".link-wishlist",addToWishList);jQuery("#product-viewed").on("click",".link-wishlist",addToWishList);jQuery("#bestseller-products").on("click",".link-wishlist",addToWishList);jQuery("#top-sales").on("click",".link-wishlist",
addToWishList);jQuery("#new-goods").on("click",".link-wishlist",addToWishList);jQuery("#product-sidebar").on("click",".link-wishlist",addToWishList);jQuery("#waiting-page").on("click",".link-wishlist",addToWishList);jQuery("#wishlist-page").on("click",".link-wishlist",addToWishList);jQuery("#articles-list").on("click",".link-wishlist",addToWishList);jQuery("#wishlist-content").on("click",".btn-remove",removeFromWishList);jQuery("#wishlist-page").on("click",".delete-link",removeFromWishList);jQuery("#wishlist-page").on("click",
".relocate-link",moveToCartFromWishlist);jQuery(document.body).on("click",".advfbx",openLoginPopupForGuests);jQuery(document.body).on("click",".btn-notice",openLoginPopupForGuests);jQuery("#waiting-page").on("click",".delete-link",removeFromWaitProductList);jQuery("#cart_holder").on("click",".move-to-wishlist",moveToWishlistFromCart);jQuery("#favs-popup-bar").on("click",".move-to-cart",moveToCartFromWishlist);jQuery("#cart_holder").on("click",".open-wishlist",openWishlist);jQuery(".share-wishlist-link").on("click",
copyWishlistShareUrl)}function moveToCartFromWishlist(e){e.preventDefault();var cartUrl=jQuery(this).attr("data-carturl");setLocation(cartUrl);jQuery("#favs-popup-bar").removeClass("popup-active")}function openLoginPopup(){AWC.closeCartSidebar();jQuery("body").addClass("layout-active");jQuery("#login").addClass("popup-active").find(".layout-close").one("click",function(event){event.preventDefault();jQuery("body").removeClass("layout-active");jQuery("#login").removeClass("popup-active")})}function moveToWishlistFromCart(e){e.preventDefault();
if(!userIsLoggedIn){openLoginPopup();return}var wishId=jQuery(this).attr("data-wishadd");var thisHref=jQuery(this).attr("href");var delUrl=thisHref.slice(thisHref.indexOf('"')+1,thisHref.lastIndexOf('"'));var cartItems=jQuery("#cart-product-container").children(".item");var thisItem=jQuery(this).closest(".item");var thisItemIndex=cartItems.index(thisItem);var itemLink=thisItem.find(".item-name");var messageElem=createMoveToWishlistMessage({name:itemLink.html(),href:itemLink.attr("href")});ajaxcartdelete(delUrl,
function(){var cartProductContainer=jQuery("#cart-product-container");if(cartProductContainer.find("li").not(".wish-message").length<=0){openWishlist();return}if(thisItemIndex===0){cartProductContainer.prepend(messageElem);return}var prevElem=cartProductContainer.children(".item").get(thisItemIndex-1);prevElem.after(messageElem)});jQuery.ajax(window.location.origin+"/wishlist/index/add",{method:"POST",data:{product:wishId},success:function(response){var respData=JSON.parse(response);if(typeof respData===
"object"){jQuery("#favs-popup-bar").find(".count").text(respData.wishlist_qty);jQuery("#wishlist_bar_show").find(".quantity").text(respData.wishlist_qty);jQuery('.link-wishlist[data-id="'+wishId+'"]').parent().toggleClass("favored");if(!respData.is_duplicate)jQuery("#wishlist-content").append(createWishlistProductMarkup(respData))}else alert("\u0421\u0435\u0440\u0432\u0435\u0440 \u0432\u0435\u0440\u043d\u0443\u043b \u043d\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435.")},
error:function(response){var respData=JSON.parse(response);if(typeof respData==="object")alert('\u041e\u0448\u0438\u0431\u043a\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0432 "\u0421\u043f\u0438\u0441\u043e\u043a \u0436\u0435\u043b\u0430\u0435\u043c\u043e\u0433\u043e".',respData.statusText);else alert("\u0421\u0435\u0440\u0432\u0435\u0440 \u0432\u0435\u0440\u043d\u0443\u043b \u043d\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435.")}})}
function createMoveToWishlistMessage(payload){var name=payload.name;var href=payload.href;var item=document.createElement("li");item=jQuery(item);item.addClass("wish-message");item.html(""+Translator.translate("Product")+" "+'<a href="'+href+'" >'+name+"</a> "+Translator.translate("moved to")+" "+'<a href="javascript:;" class="open-wishlist">'+Translator.translate("wishlist")+"</a>");return item[0]}function openWishlist(){AWC.closeCartSidebar();jQuery("#favs-popup-bar").addClass("popup-active")}function copyWishlistShareUrl(){$this=
jQuery(this);var thisTooltip=$this.closest(".share-wishlist-tooltip");var shareInput=thisTooltip.find(".share-wishlist-input");var btnClose=thisTooltip.find(".btn-close");shareInput.select();document.execCommand("copy");$this.html($this.attr("data-success-text"));setTimeout(function(){btnClose.trigger("click")},500);setTimeout(function(){$this.html($this.attr("data-default-text"))},1E3)}function buyAllSharedWishlist(){var url=jQuery(this).attr("data-url");console.log(url);jQuery.ajax({type:"GET",
url:url,success:function(response){var respData=JSON.parse(response);if(typeof respData==="object"){console.log(respData.redirect);window.location.href=respData.redirect}else alert("\u0421\u0435\u0440\u0432\u0435\u0440 \u0432\u0435\u0440\u043d\u0443\u043b \u043d\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435.")},error:function(response){var respData=JSON.parse(response);if(typeof respData==="object")alert('\u041e\u0448\u0438\u0431\u043a\u0430 \u0432 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0441\u0441\u044b\u043b\u043a\u0438 \u043d\u0430 "\u0421\u043f\u0438\u0441\u043e\u043a \u0436\u0435\u043b\u0430\u0435\u043c\u043e\u0433\u043e".',
respData.statusText);else alert("\u0421\u0435\u0440\u0432\u0435\u0440 \u0432\u0435\u0440\u043d\u0443\u043b \u043d\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435.")}})}function parseUrl(uri,key,value){var re=new RegExp("([?&])"+key+"=.*?(&|$)","i");var separator=uri.indexOf("?")!==-1?"&":"?";if(uri.match(re))return uri.replace(re,"$1"+key+"="+value+"$2");else return uri+separator+key+"="+value}function getRequestUrl(){var url;var pageNum=paginationInfo.currentPage+
1;url=window.location.href.split("#")[0];url=parseUrl(url,"p",pageNum);return url+"&json=1"}function loadMoreProducts(){jQuery(".btn-spinner").show();jQuery("#load_more_products_btn").attr("disabled","disabled");jQuery("#load_more_products_btn span").hide();jQuery.ajax({type:"GET",url:getRequestUrl(),dataType:"json",success:function(result){if(typeof result=="object"){var template=jQuery.templates("#jsRenderProductTmpl");var htmlOutput=template.render(result);jQuery("#products-list-container").append(htmlOutput);
paginationInfo.currentPage+=1;bindProductListEvents();var pagerContent=jQuery(".pages").find("li a");jQuery.each(pagerContent,function(index,value){if(jQuery(value).text()==result.page){jQuery(value).parent().addClass("current").text(result.page);jQuery(".pages").find("ol > li:last-child").remove();if(jQuery(".pages").find("ol > li:nth-last-child(1)").text()-result.page==1&&result.page!=paginationInfo.totalPages&&result.page!=paginationInfo.totalPages-1){var url=location.protocol+"//"+location.host+
location.pathname+"?p="+(+result.page+2);var text=+result.page+2;var elem='<li><a href="'+url+'">'+text+"</a></li>";jQuery(".pages").find("ol").append(jQuery(elem))}var nextUrl=location.protocol+"//"+location.host+location.pathname+"?p="+(+result.page+1);var nextElem='<li><a class="next i-next" rel="next" title="Next" style="text-decoration: none;" href="'+nextUrl+'">\u2192</a></li>';if(+result.page<+paginationInfo.totalPages)jQuery(".pages").find("ol").append(jQuery(nextElem))}});if(paginationInfo.currentPage==
paginationInfo.totalPages)jQuery("#load_more_products_btn").hide()}},error:function(result){console.log(result.responseText);alert("\u041d\u0435\u0442 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0434\u043b\u044f \u043f\u043e\u043a\u0430\u0437\u0430.")},complete:function(){jQuery(".btn-spinner").hide();jQuery("#load_more_products_btn span").show();jQuery("#load_more_products_btn").removeAttr("disabled")}})}function normalizeUrlQuery(query){query=query.replace("/?","?");query=query.replace("/&","&");
query=query.replace("?","&");query=query.replace("&","?");return query}function getFilterRequestUrl(key,optionData){var foundKey=false;var specialParam=key=="?"||typeof key=="undefined";var getParamName=function(text){var param=text.split("=")[0];return param.replace(/^\?/,"")};if(filterData.length){jQuery.each(filterData,function(index){if(~filterData[index].indexOf(key)){if(specialParam)if(getParamName(filterData[index])==getParamName(optionData))filterData[index]=key+optionData;else filterData.push("&"+
optionData);else if(key=="price")filterData[index]=key+"-"+optionData;else filterData[index]=filterData[index]+"-"+optionData;foundKey=true}});if(!foundKey)if(specialParam)filterData.push(key+optionData);else filterData.unshift(key+"-"+optionData)}else if(specialParam)filterData.push(key+optionData);else filterData.unshift(key+"-"+optionData);var url;var data;if(specialParam&&filterData.length==1)data=filterData.join("/");else data=filterPrefix+filterData.join("/");data=normalizeUrlQuery(data);url=
location.protocol+"//"+location.host+statePath+data;history.pushState(null,null,statePath+data);return url}function filterGetData(){var key=jQuery(this).parents("div.filter-item-container").data("key");if(jQuery(this).parents("div.filter-item-container").data("type")=="prolabels/catalog_layer_filter_label")jQuery(this).parents("div.filter-item-container").find("input").not(jQuery(this)).attr("checked",false);var optionData=jQuery(this).val();if(key=="price")optionData=jQuery("#minCost").val()+"-"+
jQuery("#maxCost").val();if(jQuery(this).data("id")!=undefined){optionData=jQuery(this).data("id");if(jQuery(".dior").length>0||jQuery(".brand-dior-link").length>0){var currentUrl=window.location.href;if(currentUrl.indexOf("?")!=-1)currentUrl=currentUrl.substring(0,currentUrl.indexOf("?"));if(currentUrl.indexOf("/expertise")!=-1)currentUrl=currentUrl.substring(0,currentUrl.indexOf("/expertise"));currentUrl=currentUrl+"?"+optionData;location.href=currentUrl}}if(optionData&&key)if(xhr){xhr.abort();
xhr=null;loadMoreProductsByFilter(getFilterRequestUrl(key,optionData))}else loadMoreProductsByFilter(getFilterRequestUrl(key,optionData));else if(optionData.indexOf("=")>1)if(xhr){xhr.abort();xhr=null;loadMoreProductsByFilter(getFilterRequestUrl("?",optionData))}else loadMoreProductsByFilter(getFilterRequestUrl("?",optionData));else location.href=optionData}function createFilterPagination(total){var pageCount=Math.ceil(total/productPerPage);var template=jQuery.templates("#jsRenderPagerTmpl");var pagerData=
{};var pagerLinks=[];var url;var data="";if(filterData.length){data=filterPrefix+filterData.join("/");url=location.protocol+"//"+location.host+statePath+data}else url=location.protocol+"//"+location.host+statePath;if(pageCount>1){for(var i=1;i<=pageCount&&i<=5;i++)if(i==1){var firstPage={link:i};pagerLinks.push(firstPage)}else{var otherPage={link:'<a href="'+parseUrl(url,"p",i)+'">'+i+"</a>"};pagerLinks.push(otherPage)}var nextPageButton={link:'<a class="next i-next" rel="next" title="Next" style="text-decoration: none;" href="'+
location.protocol+"//"+location.host+location.pathname+'?p=2">\u2192</a>'};pagerLinks.push(nextPageButton);pagerData.pages=pagerLinks;var htmlOutput=template.render(pagerData);jQuery("#dynamic-pager-container").append(htmlOutput);jQuery("#load_more_products_btn").show();jQuery("#dynamic-pager-container .pages .count").text(pageCount)}else jQuery("#dynamic-pager-container").append('<div class="pager pager-in-product-list"></div>')}function getUrl(){return location.protocol+"//"+location.host+location.pathname}
function updateFilters(result){var showcheckboxes=new Array;jQuery("#filter-container .filter-item-container").each(function(){if(jQuery(this).find(".checkbox-container").css("display")!="none")showcheckboxes[jQuery(this).data("key")?jQuery(this).data("key"):jQuery(this).data("type")]=1});jQuery.each(result["filters"],function(index,value){var type=value["dataKey"]?value["dataKey"]:value["dataType"];if(type in showcheckboxes)result["filters"][index]["isShowcheckboxes"]=true});if(!delClearFilterButton)jQuery(".clearfilter-container").html('<a href="'+
getUrl().split(filterPrefix).shift()+'" class="clear">\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0444\u0438\u043b\u044c\u0442\u0440</a>');else{delClearFilterButton=false;jQuery(".clearfilter-container").empty()}var template=jQuery.templates("#jsRenderFiltersTmpl");jQuery("#filter-container").find(".column").each(function(){var boxContainer=jQuery(this);var dataName=boxContainer.data("name");var numFilter=false;result["filters"].forEach(function(item,i,arr){if(dataName==item["placeHolder"])numFilter=
i});if(boxContainer.find(".filter-item-container").data("key")!="price")if(typeof numFilter=="number"&&result["filters"][numFilter]["options"].length==boxContainer.find("input").length){var identical=true;result["filters"][numFilter]["options"].forEach(function(option,i,arr){var mach=boxContainer.find('input[value="'+option["value"]+'"]');if(mach.length==0)identical=false});if(!identical){boxContainer.empty();var htmlOutput=template.render(result["filters"][numFilter]);boxContainer.html(htmlOutput);
result["filters"].splice(numFilter,1)}else result["filters"].splice(numFilter,1)}else if(typeof numFilter=="number"){boxContainer.empty();var htmlOutput=template.render(result["filters"][numFilter]);boxContainer.html(htmlOutput);result["filters"].splice(numFilter,1)}else{if(boxContainer.find(".filter-item-container").data("key")!="price")boxContainer.remove()}else result["filters"].splice(numFilter,1)});if(result["filters"].length)result["filters"].forEach(function(item,i,arr){if(item["dataKey"]!=
"price"){var htmlOutput=template.render(item);jQuery("#filter-container").find(".column:last").after('<div class="column" data-name="'+item["placeHolder"]+'">'+htmlOutput+"</div>")}});jQuery(".filter div.column select").chosen({disable_search:true});apllyScroll()}function addFilterItem(){}function loadMoreProductsByFilter(url){xhr=jQuery.ajax({type:"GET",url:url,dataType:"json",data:{json:1,filters:1},beforeSend:function(result){jQuery(".layerednavigation-overlay").show()},success:function(result){if(typeof result==
"object"){paginationInfo={currentPage:1,totalPages:Math.ceil(result.total/productPerPage),productsPerPage:productPerPage,productsTotal:result.total};var template=jQuery.templates("#jsRenderProductTmpl");var htmlOutput=template.render(result);jQuery("#products-list-container").html(htmlOutput);bindProductListEvents();initLearnbuying();if(paginationInfo.currentPage==paginationInfo.totalPages)jQuery("#load_more_products_btn").hide();jQuery(".pager").remove();jQuery("#load_more_products_btn").hide();
createFilterPagination(result.total);jQuery(".search-result").html(result.totalText);if(result.products.length)updateFilters(result);if(result.toolbar_html!=undefined)jQuery(".header-box").replaceWith(jQuery("<div>"+result.toolbar_html+"</div>").find(".header-box"));xhr=null}},complete:function(){jQuery(".layerednavigation-overlay").hide()}})}function deleteActiveFilter(event){var optiondata=jQuery(this).attr("value");var key=jQuery(this).parents("div.filter-item-container").data("key")?jQuery(this).parents("div.filter-item-container").data("key"):
jQuery(this).data("key");if(jQuery(this).data("id")!=undefined){optiondata=jQuery(this).data("id");key="?"+jQuery(this).data("id")}jQuery.each(filterData,function(index){if(filterData[index]!==undefined)if(~filterData[index].indexOf(optiondata)){var regEx;if(key=="?"||typeof key=="undefined")regEx=new RegExp(optiondata,"g");else regEx=new RegExp("-"+optiondata,"g");filterData[index]=filterData[index].replace(regEx,"");if(filterData[index]==key||filterData[index]=="?")filterData.splice(index,1)}});
var url;var data="";if(filterData.length){if(filterData.length==1&&(filterData[0].indexOf("?cat")>=0||filterData[0].indexOf("?label")>=0))data=filterData.join("/");else data=filterPrefix+filterData.join("/");data=normalizeUrlQuery(data);url=location.protocol+"//"+location.host+statePath+data}else url=location.protocol+"//"+location.host+statePath;history.pushState(null,null,statePath+data);if(!jQuery(".filter-item-container input:checked").length)delClearFilterButton=true;if(xhr){xhr.abort();xhr=
null;loadMoreProductsByFilter(url)}else loadMoreProductsByFilter(url)}function brandCategoryChange(e){var self=jQuery(this);var thisId=self.data("id");var thisUl=self.closest("ul");var subUl=thisUl.find(".sub-cat").filter('[data-sub-cat="'+thisId+'"]');console.log(self);if(jQuery(e.target).hasClass("brand-name-arrow")){subUl.slideToggle(200,function(){self.toggleClass("shown");subUl.toggleClass("shown")});return}jQuery(".brand-categories ul .brand-name").removeClass("active");if(!self.hasClass("active")){subUl.slideDown(200,
function(){self.addClass("shown");subUl.addClass("shown")});self.addClass("active");self.parents(".sub-cat").parent("li").prev(".brand-name").addClass("active");console.log(self.parents());filterGetData.apply(self[0])}else{subUl.slideUp(200,function(){self.removeClass("shown");subUl.removeClass("shown")});self.removeClass("active");deleteActiveFilter.apply(self[0])}}function bindFilterEvents(){jQuery("#filter-container").on("click",".filter-item-container label",checkboxChange);jQuery(".brand-categories .brand-name").on("click",
brandCategoryChange);jQuery("#filter-container").on("click",".filter-item-container div.chosen-container",showHideCheckboxContainer);apllyScroll();if(jQuery("#price-slider").length)activatePriceSlider();jQuery(".checkbox-container .label-text").click(function(e){e.preventDefault()})}function activatePriceSlider(){var min=typeof minPrice!="undefined"?minPrice:0;var max=typeof maxPrice!="undefined"?maxPrice:0;var minValue=typeof minPriceValue!="undefined"?minPriceValue:0;var maxValue=typeof maxPriceValue!=
"undefined"?maxPriceValue:0;var currentMinPrice=minValue?minValue:min;var currentMaxPrice=maxValue?maxValue:max;var slider=jQuery("#price-slider")[0];noUiSlider.create(slider,{start:[currentMinPrice,currentMaxPrice],connect:true,range:getSliderRange(min,max)});slider.noUiSlider.on("update",function(values,handle){jQuery("input#minCost").val(Math.floor(values[0]));jQuery("input#maxCost").val(Math.ceil(values[1]))});slider.noUiSlider.on("change",function(){filterGetData.apply(jQuery("input#minCost"))});
jQuery(document).on("change","input#minCost, input#maxCost",function(){slider.noUiSlider.set([jQuery("input#minCost").val(),jQuery("input#maxCost").val()]);filterGetData.apply(jQuery(this))})}function getSliderRange(minPrice,maxPrice){var minimumSteps=40;var range={"min":[minPrice,1],"max":[maxPrice]};var innerSteps=[[500,50],[1E3,100],[2E3,100],[3E3,100],[4E3,500],[7E3,500],[1E4,1E3],[15E3,1E3],[2E4,1E3],[3E4,1E3]];var minStep=50;while(innerSteps[0][0]<minPrice)minStep=innerSteps.shift()[1];range["0.01%"]=
[(Math.floor(minPrice/minStep)+1)*minStep,minStep];var priceDiff=maxPrice-minPrice;if(priceDiff/minStep>=minimumSteps){while(innerSteps[innerSteps.length-1][0]>maxPrice){innerSteps.pop();if(!innerSteps.length)break}innerSteps.forEach(function(step,index){var percent=Math.floor(100/(innerSteps.length+1)*(index+1));if(step[0]==range["0.01%"][0])return;range[percent+"%"]=step})}return range}function apllyScroll(){jQuery(".filter .checkbox-container").mCustomScrollbar({theme:"dark-thick",mouseWheelPixels:"400",
autoHideScrollbar:false,scrollInertia:250,scrollButtons:{enable:false}})}function checkboxChange(){var checkbox=jQuery(this).parent().find("input:checkbox");if(checkbox.prop("checked")==false){checkbox.prop("checked",true);filterGetData.apply(checkbox)}else{checkbox.prop("checked",false);deleteActiveFilter.apply(checkbox)}}function showHideCheckboxContainer(){var parent=jQuery(this).parent(".filter-item-container");jQuery(parent).find(".checkbox-container").slideToggle(100,"swing");jQuery(parent).find(".chosen-container").toggleClass("chosen-container-active chosen-with-drop")}
function sortParseUrl(uri,key,value){var re=new RegExp("([?&])"+key+"=.*?(&|$)","i");var separator=uri.indexOf("?")!==-1?"&":"?";if(uri.match(re))return uri.replace(re,"$1"+"dir="+value+"&"+"order="+key+"$2");else return uri+separator+"dir="+value+"&"+"order="+key}function sortWithFilter(element){var url;var data="";if(statePath=="/sales"&&filterData.length==0&&jQuery("#stick-sidebar-wrapper").find('.column[data-name="\u041f\u0440\u043e\u043c\u043e-\u0430\u043a\u0446\u0438\u044f"]').find(".option").find("input[checked]").length>
0){var promoAction=jQuery("#stick-sidebar-wrapper").find('.column[data-name="\u041f\u0440\u043e\u043c\u043e-\u0430\u043a\u0446\u0438\u044f"]').find(".option").find("input[checked]");var value=promoAction.val();value="?"+value;filterData.push(value)}if(filterData.length){data=filterPrefix+filterData.join("/");url=location.protocol+"//"+location.host+statePath+data}else url=location.protocol+"//"+location.host+statePath;var sortUrl=sortParseUrl(url,jQuery(element).find(":selected").data("key"),jQuery(element).find(":selected").data("value"));
history.pushState(null,null,sortUrl);loadMoreProductsByFilter(sortUrl)}function saveProductListNavigationData(){localStorage.setItem("productList",function(){var html="";jQuery("#products-list-container .product-item").slice(paginationInfo.productsPerPage).each(function(){html+=this.outerHTML});return html}());localStorage.setItem("pagination",jQuery(".pager-in-product-list .pages").html());localStorage.setItem("productListUrl",window.location.href.split("#")[0]);localStorage.setItem("currentPage",
paginationInfo.currentPage)}function restoreProductListNavigationData(){if(window.location.hash!="#loaded"||localStorage.productListUrl!=window.location.href.split("#")[0])return;history.pushState(null,null,localStorage.productListUrl);if(localStorage.productList){jQuery("#products-list-container").append(localStorage.productList);if(localStorage.pagination){jQuery(".pager-in-product-list .pages").html(localStorage.pagination);paginationInfo.currentPage=+localStorage.currentPage;if(paginationInfo.currentPage==
paginationInfo.totalPages)jQuery("#load_more_products_btn").hide()}}restoreScrollPosition()}function saveScrollPosition(){if(!jQuery("#products-list-container .product-item").length)return;localStorage.setItem("scrollTop",jQuery(document).scrollTop());localStorage.setItem("scrollWidth",jQuery(document).width())}function restoreScrollPosition(){if(!localStorage.scrollTop)return;jQuery(document).scrollTop(localStorage.scrollTop)}return{init:init,destroy:destroy}}();jQuery(function(){categoryModule.init()});
(function($){$(document).ready(function(){var sidebar=document.getElementById("stick-sidebar-wrapper");if(sidebar){var initScrollVars=function(){isScrolledBrandLogo=0;maxScroll=sidebar.scrollHeight-sidebar.offsetHeight;maxWindowScroll=document.documentElement.scrollHeight-document.documentElement.clientHeight;brandLogoHeight=$(".filters-brand-logo").height()};var isScrolledBrandLogo,maxScroll,brandLogoHeight,maxWindowScroll;initScrollVars();$(window).resize(function(){initScrollVars()});window.onscroll=
function(){var scrolled=$(document).scrollTop();var scrolledPercent=scrolled*100/maxWindowScroll;var moveScroll=scrolledPercent*maxScroll/100;if(brandLogoHeight!=null&&moveScroll>brandLogoHeight)isScrolledBrandLogo=1;if(isScrolledBrandLogo&&moveScroll<brandLogoHeight)moveScroll=brandLogoHeight;$("#stick-sidebar-wrapper").animate({scrollTop:moveScroll},0)};$(".filter-item-container").each(function(){var showcheckboxes=$(this).data("showcheckboxes");if(showcheckboxes||$(this).find("input").prop("checked"))$(this).find(".checkbox-container").show()})}if(jQuery(".brand-categories li.active").length)jQuery(".brand-categories li.active").parent().addClass("active")})})(jQuery);
